<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Boston Fire Hydrants Map</title>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-geo.v2.min.js"></script>
    <style>
        #map {
            width: 800px;
            height: 600px;
        }
    </style>
</head>
<body>
    <h1>Boston Fire Hydrants Map</h1>
    <svg id="map"></svg>
    <script>
        const svg = d3.select("#map"),
            width = +svg.attr("width"),
            height = +svg.attr("height");

        const projection = d3.geoMercator()
                             .center([-71.0589, 42.3601]) // Longitude and latitude of Boston
                             .scale(100000) // Scale for zooming into the city
                             .translate([width / 2, height / 2]);

        const path = d3.geoPath().projection(projection);

        // Fetch data from Boston Data API
        d3.json("https://data.boston.gov/api/3/action/datastore_search_sql?sql=SELECT * from \"1479a183-dde0-46a6-a828-f526df010a03\"")
            .then(data => {
                const hydrants = data.result.records;
                hydrants.forEach(d => {
                    if (!isNaN(parseFloat(d.Longitude)) && !isNaN(parseFloat(d.Latitude))) {
                        svg.append("circle")
                           .attr("cx", projection([parseFloat(d.Longitude), parseFloat(d.Latitude)])[0])
                           .attr("cy", projection([parseFloat(d.Longitude), parseFloat(d.Latitude)])[1])
                           .attr("r", 5)
                           .style("fill", "red")
                           .append("title")
                           .text(`ID: ${d._id}, Location: ${d.PLACEMENT_}`);
                    }
                });
            })
            .catch(err => console.error('Error loading the map data:', err));
    </script>
</body>
</html>
